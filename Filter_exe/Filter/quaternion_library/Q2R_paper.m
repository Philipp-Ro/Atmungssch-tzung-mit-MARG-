function R = Q2R_paper(q)
    %% Quaternion normieren
    Z = sqrt(q(:,1).^2 + q(:,2).^2 + q(:,3).^2 + q(:,4).^2);
    q_z = [q(:,1)./Z q(:,2)./Z q(:,3)./Z q(:,4)./Z];
    
    %% RotMat erste Zeile
    R(1,1,:) = 2*q_z(:,1)^2 - 1 + 2*q_z(:,2)^2;
    R(1,2,:) = 2*( q_z(:,2)*q_z(:,3) + q_z(:,1)*q_z(:,4) );
    R(1,3,:) = 2*( q_z(:,2)*q_z(:,4) - q_z(:,1)*q_z(:,3) );
    
    %% RotMat zweite Zeile
    R(2,1,:) = 2*( q_z(:,2)*q_z(:,3) - q_z(:,1)*q_z(:,4) );
    R(2,2,:) = 2*q_z(:,1)^2 - 1 + 2*q_z(:,3)^2;
    R(2,3,:) = 2*( q_z(:,3)*q_z(:,4) + q_z(:,1)*q_z(:,2) );
    
    %% RotMat dritte Zeile
    R(3,1,:) = 2*( q_z(:,2)*q_z(:,4) + q_z(:,1)*q_z(:,3) );
    R(3,2,:) = 2*( q_z(:,3)*q_z(:,4) - q_z(:,1)*q_z(:,2) );
    R(3,3,:) = 2*q_z(:,1)^2 - 1 + 2*q_z(:,4)^2;
end